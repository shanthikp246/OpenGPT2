# The manifest for the "api" service.
name: api
type: Load Balanced Web Service

http:
  path: "/"
  healthcheck:
    path: "/health"
    interval: 60s
    timeout: 30s
    retries: 5
    start_period: 120s  # allow 2 minutes for model loading


image:
  build: Dockerfile
  port: 8000

cpu: 2048
memory: 4096
platform: linux/x86_64
count: 1
exec: true
network:
  connect: true

task:
  permissions:
    statements:
      - Effect: Allow
        Action:
          - s3:ListBucket
        Resource:
          - arn:aws:s3:::*
      - Effect: Allow
        Action:
          - s3:GetObject
          - s3:PutObject
          - s3:DeleteObject
        Resource:
          - arn:aws:s3:::*/*
